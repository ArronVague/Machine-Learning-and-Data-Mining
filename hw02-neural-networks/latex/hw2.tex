\documentclass{article}
\usepackage{amsmath}
\usepackage{titlesec}

\title{Homework 2}
\author{Student ID: 21311570}

% \setcounter{secnumdepth}{0} % Remove section numbering

\begin{document}

\maketitle

\section{Forward propagation}

\[
    a^{[0]} = x = \begin{bmatrix}
        \frac{0.21+0.70}{2} \\
        \frac{0.31+0.70}{2} \\
    \end{bmatrix}
    = \begin{bmatrix}
        0.455 \\
        0.505 \\
    \end{bmatrix},
    \quad
    y = \begin{bmatrix}
        \frac{0.15+0.70}{2} \\
        0.70                \\
    \end{bmatrix}
    = \begin{bmatrix}
        0.425 \\
        0.700 \\
    \end{bmatrix}
\]

\subsection{From the question}

\[
    \omega^{[1]} = \begin{bmatrix}
        0.1 & 0.8 \\
        0.4 & 0.6 \\
        0.3 & 0.5 \\
    \end{bmatrix},
    \quad
    \omega^{[2]} = \begin{bmatrix}
        % [0.9, 0.2, 0.7], [0.6, 0.3, 0.7], [0.1, 0.8, 0.5]
        0.9 $ 0.2 $ 0.7 \\
        0.6 $ 0.3 $ 0.7 \\
        0.1 $ 0.8 $ 0.5 \\
    \end{bmatrix},
    \quad
    \omega^{[3]} = \begin{bmatrix}
        % [0.4, 0.3, 0.5], [0.6, 0.2, 0.8]
        0.4 $ 0.3 $ 0.5 \\
        0.6 $ 0.2 $ 0.8 \\
    \end{bmatrix}
\]

\[
    \quad
    b^{[1]} = b^{[2]} = \begin{bmatrix}
        0 \\
        0 \\
        0 \\
    \end{bmatrix},
    \quad
    b^{[3]} = \begin{bmatrix}
        0 \\
        0 \\
    \end{bmatrix},
    \quad
    \sigma^{[1]} = \sigma^{[2]} = \sigma^{[3]} = \frac{1}{1+e^{-z}}
\]

\subsection{Calculation}

When $l = 1$ :

\[
    z^{[1]} = \omega^{[1]} a^{[0]} + b^{[1]} = \begin{bmatrix}
        0.1 & 0.8 \\
        0.4 & 0.6 \\
        0.3 & 0.5 \\
    \end{bmatrix}
    \begin{bmatrix}
        0.455 \\
        0.505 \\
    \end{bmatrix}
    + \begin{bmatrix}
        0 \\
        0 \\
        0 \\
    \end{bmatrix}
    = \begin{bmatrix}
        0.4495 \\
        0.485  \\
        0.389  \\
    \end{bmatrix}
\]

\[
    a^{[1]} = \sigma^{[1]}(z^{[1]}) = \begin{bmatrix}
        \frac{1}{1+e^{-0.4495}} \\
        \frac{1}{1+e^{-0.485}}  \\
        \frac{1}{1+e^{-0.389}}  \\
    \end{bmatrix}
    = \begin{bmatrix}
        0.61052035 \\
        0.61892785 \\
        0.59604195 \\
    \end{bmatrix}
\]

\noindent When $l = 2$ :

\[
    z^{[2]} = \omega^{[2]} a^{[1]} + b^{[2]} = \begin{bmatrix}
        % [0.9, 0.2, 0.7], [0.6, 0.3, 0.7], [0.1, 0.8, 0.5]
        0.9 $ 0.2 $ 0.7 \\
        0.6 $ 0.3 $ 0.7 \\
        0.1 $ 0.8 $ 0.5 \\
    \end{bmatrix}
    \begin{bmatrix}
        0.61052035 \\
        0.61892785 \\
        0.59604195 \\
    \end{bmatrix}
    + \begin{bmatrix}
        0 \\
        0 \\
        0 \\
    \end{bmatrix}
    = \begin{bmatrix}
        % 1.09048325 0.96921993 0.85421529
        1.09048325 \\
        0.96921993 \\
        0.85421529 \\
    \end{bmatrix}
\]

\[
    a^{[2]} = \sigma^{[2]}(z^{[2]}) = \begin{bmatrix}
        % 0.74847593 0.72408079 0.70173183
        \frac{1}{1+e^{-1.09048325}} \\
        \frac{1}{1+e^{-0.96921993}} \\
        \frac{1}{1+e^{-0.85421529}} \\
    \end{bmatrix}
    = \begin{bmatrix}
        % 0.74847271 0.72496399 0.70145065
        0.74847271 \\
        0.72496399 \\
        0.70145065 \\
    \end{bmatrix}
\]

\noindent When $l = 3$ :

\[
    z^{[3]} = \omega^{[3]} a^{[2]} + b^{[3]} = \begin{bmatrix}
        % [0.4, 0.3, 0.5], [0.6, 0.2, 0.8]
        0.4 $ 0.3 $ 0.5 \\
        0.6 $ 0.2 $ 0.8 \\
    \end{bmatrix}
    \begin{bmatrix}
        % 0.74847271 0.72496399 0.70145065
        0.74847271 \\
        0.72496399 \\
        0.70145065 \\
    \end{bmatrix}
    + \begin{bmatrix}
        0 \\
        0 \\
    \end{bmatrix}
    = \begin{bmatrix}
        % 0.8676036  1.15523694
        0.8676036  \\
        1.15523694 \\
    \end{bmatrix}
\]

\[
    \widehat{y} = a^{[3]} = \sigma^{[3]}(z^{[3]}) = \begin{bmatrix}
        \frac{1}{1+e^{-0.8676036}}  \\
        \frac{1}{1+e^{-1.15523694}} \\
    \end{bmatrix}
    = \begin{bmatrix}
        % 0.70424681 0.76046617
        0.70424681 \\
        0.76046617 \\
    \end{bmatrix}
\]

\section{Backward propagation}

\subsection{From the question}

\[
    L(y, \widehat{y})=\frac{1}{2}\sum(y-\widehat{y})^2
\]

\subsection{Calculation}

\[
    \frac{\partial L}{\partial a^{[3]}}=\widehat{y}-y=\begin{bmatrix}
        % 0.70424681 0.76046617
        0.70424681 \\
        0.76046617 \\
    \end{bmatrix}
    - \begin{bmatrix}
        % 0.425 0.700
        0.425 \\
        0.700 \\
    \end{bmatrix}
    = \begin{bmatrix}
        % 0.27924681 0.06046617
        0.27924681 \\
        0.06046617 \\
    \end{bmatrix}
\]

\[
    \begin{aligned}
        \delta^{[3]} & = \frac{\partial L}{\partial z^{[3]}} = \frac{\partial L}{\partial a^{[3]}}*\sigma^{[3]'}(z^{[3]}) \\
                     & = \begin{bmatrix}
                             % 0.27924681 0.06046617
                             0.27924681 \\
                             0.06046617 \\
                         \end{bmatrix}
        * \begin{bmatrix}
              % 0.20828324 0.18215738
              0.20828324 \\
              0.18215738 \\
          \end{bmatrix}
        = \begin{bmatrix}
              % 0.05816243 0.01101436
              0.05816243 \\
              0.01101436 \\
          \end{bmatrix}
    \end{aligned}
\]

\[
    \begin{aligned}
        \delta^{[2]} & = \frac{\partial L}{\partial z^{[2]}} = \omega^{[3]T}\cdot dz^{[3]}*\sigma^{[2]'}(z^{[2]}) \\
                     & = \begin{bmatrix}
                             0.4 & 0.6 \\
                             0.3 & 0.2 \\
                             0.5 & 0.8 \\
                         \end{bmatrix}
        \begin{bmatrix}
            % 0.05816243 0.01101436
            0.05816243 \\
            0.01101436 \\
        \end{bmatrix}
        * \begin{bmatrix}
              % 0.18826131 0.19939121 0.20941764
              0.18826131 \\
              0.19939121 \\
              0.20941764 \\
          \end{bmatrix}
        = \begin{bmatrix}
              % 0.00562404 0.00391836 0.0079354
              0.00562404 \\
              0.00391836 \\
              0.0079354  \\
          \end{bmatrix}
    \end{aligned}
\]

\[
    \begin{aligned}
        \delta^{[1]} & = \frac{\partial L}{\partial z^{[1]}} = \omega^{[2]T}\cdot dz^{[2]}*\sigma^{[1]'}(z^{[1]}) \\
                     & = \begin{bmatrix}
                             0.9 & 0.6 & 0.1 \\
                             0.2 & 0.3 & 0.8 \\
                             0.7 & 0.7 & 0.5 \\
                         \end{bmatrix}
        \begin{bmatrix}
            % 0.00562404 0.00391836 0.0079354
            0.00562404 \\
            0.00391836 \\
            0.0079354  \\
        \end{bmatrix}
        * \begin{bmatrix}
              % 0.23778525 0.23585617 0.24077594
              0.23778525 \\
              0.23585617 \\
              0.24077594 \\
          \end{bmatrix}
        = \begin{bmatrix}
              % 0.00195131 0.00203983 0.00256363
              0.00195131 \\
              0.00203983 \\
              0.00256363 \\
          \end{bmatrix}
    \end{aligned}
\]

\section{Parameter update}

\subsection{From the question}

\[
    \eta = 0.8
\]

\subsection{Calculation}

When $l = 3$ :

\[
    \begin{aligned}
        \omega^{[3]} & =\omega^{[3]}-\eta\delta^{[3]}a^{[2]T} \\
                     & =\begin{bmatrix}
                            % [0.4, 0.3, 0.5], [0.6, 0.2, 0.8]
                            0.4 $ 0.3 $ 0.5 \\
                            0.6 $ 0.2 $ 0.8 \\
                        \end{bmatrix}
        - 0.8 \begin{bmatrix}
                  % 0.05816243 0.01101436
                  0.05816243 \\
                  0.01101436 \\
              \end{bmatrix}
        \begin{bmatrix}
            % 0.74847271 0.72496399 0.70145065
            0.74847271 \\
            0.72496399 \\
            0.70145065 \\
        \end{bmatrix}^{\mathsf{T}}                      \\
                     & = \begin{bmatrix}
                             % [0.36517361 0.26626747 0.46736154]
                             %  [0.59340484 0.19361199 0.79381918]
                             0.36517361 $ 0.26626747 $ 0.46736154 \\
                             0.59340484 $ 0.19361199 $ 0.79381918 \\
                         \end{bmatrix}
    \end{aligned}
\]

\[
    \begin{aligned}
        b^{[3]} & =b^{[3]}-\eta\delta^{[3]} \\
                & =\begin{bmatrix}
                       0 \\
                       0 \\
                   \end{bmatrix}
        - 0.8 \begin{bmatrix}
                  % 0.05816243 0.01101436
                  0.05816243 \\
                  0.01101436 \\
              \end{bmatrix}
        = \begin{bmatrix}
              % -0.04652994 -0.00881149
              -0.04652994 \\
              -0.00881149 \\
          \end{bmatrix}
    \end{aligned}
\]

\noindent When $l = 2$ :

\[
    \begin{aligned}
        \omega^{[2]} & =\omega^{[2]}-\eta\delta^{[2]}a^{[1]T} \\
                     & =\begin{bmatrix}
                            % [0.9, 0.2, 0.7], [0.6, 0.3, 0.7], [0.1, 0.8, 0.5]
                            0.9 $ 0.2 $ 0.7 \\
                            0.6 $ 0.3 $ 0.7 \\
                            0.1 $ 0.8 $ 0.5 \\
                        \end{bmatrix}
        - 0.8 \begin{bmatrix}
                  % 0.00562404 0.00391836 0.0079354
                  0.00562404 \\
                  0.00391836 \\
                  0.0079354  \\
              \end{bmatrix}
        \begin{bmatrix}
            % 0.61052035 0.61892785 0.59604195
            0.61052035 \\
            0.61892785 \\
            0.59604195 \\
        \end{bmatrix}^{\mathsf{T}}                      \\
                     & = \begin{bmatrix}
                             % [0.89725313 0.1972153  0.69731827]
                             %  [0.59808621 0.29805986 0.6981316 ]
                             %  [0.09612422 0.79607085 0.49621613]
                             0.89725313 $ 0.1972153  $ 0.69731827 \\
                             0.59808621 $ 0.29805986 $ 0.6981316  \\
                             0.09612422 $ 0.79607085 $ 0.49621613 \\
                         \end{bmatrix}
    \end{aligned}
\]

\[
    \begin{aligned}
        b^{[2]} & =b^{[2]}-\eta\delta^{[2]} \\
                & =\begin{bmatrix}
                       0 \\
                       0 \\
                       0 \\
                   \end{bmatrix}
        - 0.8 \begin{bmatrix}
                  % 0.00562404 0.00391836 0.0079354
                  0.00562404 \\
                  0.00391836 \\
                  0.0079354  \\
              \end{bmatrix}
        = \begin{bmatrix}
              % -0.00449923 -0.00313469 -0.00634832
              -0.00449923 \\
              -0.00313469 \\
              -0.00634832 \\
          \end{bmatrix}
    \end{aligned}
\]

\noindent When $l = 1$ :

\[
    \begin{aligned}
        \omega^{[1]} & =\omega^{[1]}-\eta\delta^{[1]}a^{[0]T} \\
                     & =\begin{bmatrix}
                            0.1 & 0.8 \\
                            0.4 & 0.6 \\
                            0.3 & 0.5 \\
                        \end{bmatrix}
        - 0.8 \begin{bmatrix}
                  % 0.00195131 0.00203983 0.00256363
                  0.00195131 \\
                  0.00203983 \\
                  0.00256363 \\
              \end{bmatrix}
        \begin{bmatrix}
            % 0.455 0.505
            0.455 \\
            0.505 \\
        \end{bmatrix}^{\mathsf{T}}                      \\
                     & = \begin{bmatrix}
                             % 0.09928972 0.79921167]
                             %  [0.3992575  0.59917591]
                             %  [0.29906684 0.49896429]
                             0.09928972 $ 0.79921167 $ \\
                             0.3992575  $ 0.59917591 $ \\
                             0.29906684 $ 0.49896429 $ \\
                         \end{bmatrix}
    \end{aligned}
\]

\[
    \begin{aligned}
        b^{[1]} & =b^{[1]}-\eta\delta^{[1]} \\
                & =\begin{bmatrix}
                       0 \\
                       0 \\
                       0 \\
                   \end{bmatrix}
        - 0.8 \begin{bmatrix}
                  % 0.00195131 0.00203983 0.00256363
                  0.00195131 \\
                  0.00203983 \\
                  0.00256363 \\
              \end{bmatrix}
        = \begin{bmatrix}
              % -0.00156105 -0.00163187 -0.00205091
              -0.00156105 \\
              -0.00163187 \\
              -0.00205091 \\
          \end{bmatrix}
    \end{aligned}
\]

\end{document}

